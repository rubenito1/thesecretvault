const key = localStorage.getItem("vault_key");
const file = localStorage.getItem("vault_file");

if(!key || !file) window.location.href="index.html";

fetch(file)
.then(r => r.text())
.then(enc => {
  enc = enc.trim();
  let decrypted = "";
  try { decrypted = CryptoJS.AES.decrypt(enc, key).toString(CryptoJS.enc.Utf8); } catch {}

  if(!decrypted || decrypted.length < 5) {
    document.getElementById("content").innerHTML = "<h2>Acceso denegado</h2>";
    return;
  }

  document.getElementById("content").innerHTML = decrypted;
});
